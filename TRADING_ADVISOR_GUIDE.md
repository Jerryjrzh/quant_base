# 交易操作顾问系统使用指南

## 概述

这个交易操作顾问系统解决了你提到的问题：**战略选择策略，战术制定操作，现在有了具体的买入卖出价格参考**。

系统分为三个层次：
- **战略层面**: 策略信号识别（MACD零轴启动等）
- **战术层面**: 根据信号状态制定入场计划
- **操作层面**: 具体的买入卖出价格建议

## 核心功能

### 1. 入场操作建议

根据信号状态提供不同的入场策略：

#### PRE状态（预备阶段）
- **分批建仓**: 首次30%，回调后加仓40%
- **支撑位买入**: 等待回调至技术支撑位
- **风险较低**: 可以相对激进一些

#### MID状态（进行中）
- **突破确认买入**: 确认突破后快速建仓
- **当日低点买入**: 利用日内波动建仓
- **时机关键**: 需要快速决策

#### POST状态（已突破）
- **回调买入**: 等待5-8%回调后介入
- **强势追涨**: 不回调时小仓位参与
- **风险较高**: 需要谨慎操作

### 2. 出场操作建议

根据当前盈亏状况提供出场策略：

#### 大幅盈利（>15%）
- 分批获利了结，减仓50%
- 移动止损保护利润

#### 中等盈利（5-15%）
- 部分获利，减仓30%
- 提高止损至成本价附近

#### 盈亏平衡（±5%）
- 耐心持有观察
- 严格执行预设止损

#### 亏损状态（<-3%）
- 及时止损出场
- 分析失败原因

### 3. 风险管理

#### 止损设置
- **保守止损**: 3%止损
- **适中止损**: 5%止损  
- **激进止损**: 8%止损
- **技术止损**: 基于支撑位

#### 仓位管理
- **保守**: 总资金20-30%
- **适中**: 总资金30-50%
- **激进**: 总资金50-70%

#### 风险警报
- 持有时间过长警报
- 大幅亏损警报
- 成交量异常警报

## 使用方法

### 1. 快速获取建议

```bash
# 自动检测信号并给出建议
python get_trading_advice.py sh000001

# 指定信号状态
python get_trading_advice.py sz000001 PRE

# 已入场，获取出场建议
python get_trading_advice.py sh600000 MID 12.50
```

### 2. 详细分析报告

```bash
# 运行完整的交易顾问演示
python run_trading_advisor.py
```

### 3. 集成到现有系统

```python
from trading_advisor import TradingAdvisor

advisor = TradingAdvisor()

# 获取入场建议
entry_advice = advisor.get_entry_recommendations(df, signal_idx, signal_state)

# 获取出场建议
exit_advice = advisor.get_exit_recommendations(df, entry_idx, entry_price)

# 生成完整报告
report = advisor.generate_trading_report(df, signal_idx, signal_state, entry_price)
```

## 实际应用示例

### 场景1: 发现PRE信号
```
📊 sh000001 交易建议
📅 日期: 2021-06-30
🎯 信号: PRE
💰 价格: ¥3559.79

🚀 入场建议:
  策略: 分批建仓
  价位1: ¥3519.38  (回调2%买入)
  价位2: ¥3411.64  (回调5%加仓)
  仓位: 首次30%，回调后加仓40%

⚠️ 止损建议:
  适中止损: ¥3411.64
  技术止损: ¥3517.21
```

### 场景2: 持仓管理
```
📈 持仓状态:
  当前盈亏: +8.5%
  持有天数: 15天

🎯 价格目标:
  止损位: ¥3411.64
  目标位: ¥3806.67

💡 当前建议:
  当前盈利8.5%，可考虑减仓30%
```

## 系统优势

### 1. 精确的价格参考
- 不再是模糊的"低买高卖"
- 具体到小数点后两位的价格建议
- 基于技术分析的科学定价

### 2. 动态的策略调整
- 根据信号状态调整策略
- 根据盈亏状况调整操作
- 根据市场环境调整风险

### 3. 完整的风险控制
- 多层次止损设置
- 仓位管理建议
- 风险警报系统

### 4. 易于使用
- 命令行快速查询
- 详细报告生成
- 可集成到现有系统

## 注意事项

1. **数据依赖**: 需要准确的股票数据
2. **市场变化**: 建议需要结合实时市场情况
3. **风险控制**: 严格执行止损纪律
4. **持续优化**: 根据实际效果调整参数

## 下一步改进

1. **实时数据接入**: 连接实时行情数据
2. **多策略支持**: 扩展到更多交易策略
3. **回测验证**: 历史数据验证建议准确性
4. **移动端支持**: 开发手机应用
5. **智能提醒**: 价格到位自动提醒

---

这个系统真正实现了从**战略到战术再到操作**的完整闭环，让交易决策更加科学和精确！