<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>布局优化测试</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.3.3/dist/echarts.min.js"></script>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: #f0f2f5; 
            margin: 0;
            padding: 0;
        }
        
        .app-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .app-header h1 {
            margin: 0 0 1rem 0;
            font-size: 1.8rem;
            font-weight: 600;
        }
        
        .app-container {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            padding: 1.5rem;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .main-content {
            display: flex;
            gap: 1.5rem;
        }
        
        .chart-section {
            flex: 4;
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        #chart-container { 
            width: 100%; 
            height: 650px; 
        }
        
        .sidebar {
            flex: 0 0 280px;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            min-width: 280px;
            max-width: 280px;
        }
        
        .trading-advice-panel {
            background: white;
            padding: 1rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        .backtest-panel {
            background: white;
            padding: 1rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        .advice-header {
            border-bottom: 2px solid #f0f2f5;
            padding-bottom: 0.8rem;
            margin-bottom: 1rem;
        }
        
        .advice-header h3 {
            margin: 0;
            color: #2c3e50;
            font-size: 1rem;
        }
        
        .action-recommendation {
            text-align: center;
            padding: 0.8rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            background: #d4edda;
            color: #155724;
        }
        
        .action-text {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
        }
        
        .confidence-text {
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        .price-levels {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.6rem;
            margin-bottom: 1rem;
        }
        
        .price-item {
            text-align: center;
            padding: 0.5rem;
            background: #f8f9fa;
            border-radius: 6px;
        }
        
        .price-label {
            font-size: 0.7rem;
            color: #6c757d;
            margin-bottom: 0.2rem;
        }
        
        .price-value {
            font-size: 0.85rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .analysis-logic h4 {
            margin: 0 0 0.6rem 0;
            color: #2c3e50;
            font-size: 0.9rem;
        }
        
        .logic-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 0.5rem;
            font-size: 0.8rem;
            line-height: 1.3;
        }
        
        .logic-icon {
            color: #007bff;
            margin-right: 0.5rem;
            font-weight: bold;
        }
        
        .layout-info {
            background: #e3f2fd;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }
        
        .layout-info h4 {
            margin: 0 0 0.5rem 0;
            color: #1976d2;
        }
        
        .layout-info ul {
            margin: 0;
            padding-left: 1.2rem;
        }
        
        .layout-info li {
            margin-bottom: 0.3rem;
        }
    </style>
</head>
<body>
    <header class="app-header">
        <h1>布局优化测试 - 图表区域扩大</h1>
    </header>
    
    <main class="app-container">
        <div class="layout-info">
            <h4>🎯 布局优化说明</h4>
            <ul>
                <li>图表区域从 flex: 3 调整为 flex: 4，占用更多空间</li>
                <li>右侧面板固定宽度280px，更紧凑的设计</li>
                <li>减少了面板内部的padding和margin</li>
                <li>优化了字体大小和间距，提高空间利用率</li>
            </ul>
        </div>
        
        <div class="main-content">
            <div class="chart-section">
                <div id="chart-container"></div>
            </div>
            
            <div class="sidebar">
                <div class="backtest-panel">
                    <h3 style="margin: 0 0 0.8rem 0; color: #2c3e50; font-size: 1rem;">回测表现</h3>
                    <div class="backtest-summary" style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.6rem; margin-bottom: 0.8rem; font-size: 0.8rem;">
                        <div style="background: #f8f9fa; padding: 0.4rem; border-radius: 4px; text-align: center;">
                            <div style="color: #6c757d; font-size: 0.7rem;">总信号</div>
                            <div style="font-weight: 600; color: #2c3e50; font-size: 0.85rem;">45</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 0.4rem; border-radius: 4px; text-align: center;">
                            <div style="color: #6c757d; font-size: 0.7rem;">胜率</div>
                            <div style="font-weight: 600; color: #2c3e50; font-size: 0.85rem;">68.9%</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 0.4rem; border-radius: 4px; text-align: center;">
                            <div style="color: #6c757d; font-size: 0.7rem;">平均收益</div>
                            <div style="font-weight: 600; color: #28a745; font-size: 0.85rem;">5.2%</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 0.4rem; border-radius: 4px; text-align: center;">
                            <div style="color: #6c757d; font-size: 0.7rem;">平均回撤</div>
                            <div style="font-weight: 600; color: #dc3545; font-size: 0.85rem;">-2.1%</div>
                        </div>
                    </div>
                    <div class="state-stats-container">
                        <h4 style="margin: 0 0 0.6rem 0; color: #2c3e50; font-size: 0.9rem;">状态统计</h4>
                        <div style="font-size: 0.75rem;">
                            <div style="margin-bottom: 0.3rem;">PRE: 15个信号, 胜率 73.3%</div>
                            <div style="margin-bottom: 0.3rem;">MID: 18个信号, 胜率 66.7%</div>
                            <div>POST: 12个信号, 胜率 66.7%</div>
                        </div>
                    </div>
                </div>
                
                <div class="trading-advice-panel">
                    <div class="advice-header">
                        <h3>交易建议</h3>
                        <button style="float: right; padding: 0.3rem 0.8rem; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.8rem;">刷新</button>
                    </div>
                    <div class="advice-content">
                        <div class="action-recommendation">
                            <div class="action-text">建议买入</div>
                            <div class="confidence-text">置信度: 85%</div>
                        </div>
                        
                        <div class="price-levels">
                            <div class="price-item">
                                <div class="price-label">当前价格</div>
                                <div class="price-value">96.38</div>
                            </div>
                            <div class="price-item">
                                <div class="price-label">建议入场</div>
                                <div class="price-value">95.78</div>
                            </div>
                            <div class="price-item">
                                <div class="price-label">目标价位</div>
                                <div class="price-value">102.50</div>
                            </div>
                            <div class="price-item">
                                <div class="price-label">止损价位</div>
                                <div class="price-value">92.15</div>
                            </div>
                            <div class="price-item">
                                <div class="price-label">阻力位</div>
                                <div class="price-value">98.45</div>
                            </div>
                            <div class="price-item">
                                <div class="price-label">支撑位</div>
                                <div class="price-value">94.20</div>
                            </div>
                        </div>
                        
                        <div class="analysis-logic">
                            <h4>分析逻辑</h4>
                            <div class="logic-item">
                                <span class="logic-icon">•</span>
                                <span>MACD即将金叉，动能转强</span>
                            </div>
                            <div class="logic-item">
                                <span class="logic-icon">•</span>
                                <span>RSI处于超卖区域反弹</span>
                            </div>
                            <div class="logic-item">
                                <span class="logic-icon">•</span>
                                <span>成交量放大，资金流入</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // 初始化图表
        const myChart = echarts.init(document.getElementById('chart-container'));
        
        // 模拟数据
        const dates = [];
        const klineData = [];
        const difData = [];
        const deaData = [];
        const macdData = [];
        
        // 生成30天的模拟数据
        for (let i = 0; i < 30; i++) {
            const date = new Date();
            date.setDate(date.getDate() - (29 - i));
            dates.push(date.toISOString().split('T')[0]);
            
            const basePrice = 95 + Math.sin(i * 0.2) * 5;
            const open = basePrice + (Math.random() - 0.5) * 2;
            const close = open + (Math.random() - 0.5) * 3;
            const high = Math.max(open, close) + Math.random() * 2;
            const low = Math.min(open, close) - Math.random() * 2;
            
            klineData.push([open, close, low, high]);
            
            difData.push(Math.sin(i * 0.3) * 0.5);
            deaData.push(Math.sin(i * 0.3 - 0.2) * 0.4);
            macdData.push((Math.sin(i * 0.3) - Math.sin(i * 0.3 - 0.2)) * 0.3);
        }
        
        const option = {
            title: {
                text: '布局优化测试 - SZ000001',
                left: 'center',
                textStyle: { fontSize: 16 }
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: { type: 'cross' }
            },
            legend: {
                data: ['K线', 'DIF', 'DEA', 'MACD'],
                top: 30
            },
            grid: [
                { left: '8%', right: '5%', top: '8%', height: '60%' },      // K线
                { left: '8%', right: '5%', top: '72%', height: '25%' }      // MACD
            ],
            xAxis: [
                { 
                    type: 'category', 
                    data: dates, 
                    gridIndex: 0,
                    axisLabel: { show: false }
                },
                { 
                    type: 'category', 
                    data: dates, 
                    gridIndex: 1
                }
            ],
            yAxis: [
                { 
                    gridIndex: 0,
                    scale: true
                },
                { 
                    gridIndex: 1,
                    scale: true
                }
            ],
            dataZoom: [
                { 
                    type: 'inside', 
                    xAxisIndex: [0, 1],
                    start: 50,
                    end: 100
                },
                { 
                    show: true, 
                    xAxisIndex: [0, 1], 
                    type: 'slider', 
                    bottom: '2%',
                    height: 20
                }
            ],
            series: [
                {
                    name: 'K线',
                    type: 'candlestick',
                    data: klineData,
                    xAxisIndex: 0,
                    yAxisIndex: 0
                },
                {
                    name: 'DIF',
                    type: 'line',
                    data: difData,
                    smooth: true,
                    symbol: 'none',
                    xAxisIndex: 1,
                    yAxisIndex: 1,
                    lineStyle: { color: '#2ecc71', width: 2 }
                },
                {
                    name: 'DEA',
                    type: 'line',
                    data: deaData,
                    smooth: true,
                    symbol: 'none',
                    xAxisIndex: 1,
                    yAxisIndex: 1,
                    lineStyle: { color: '#e67e22', width: 2 }
                },
                {
                    name: 'MACD',
                    type: 'bar',
                    data: macdData,
                    xAxisIndex: 1,
                    yAxisIndex: 1,
                    itemStyle: {
                        color: function(params) {
                            return params.value >= 0 ? '#ff6b6b' : '#4ecdc4';
                        }
                    },
                    barWidth: '60%'
                }
            ]
        };
        
        myChart.setOption(option);
        
        // 响应式调整
        window.addEventListener('resize', function() {
            myChart.resize();
        });
        
        console.log('布局优化测试页面加载完成');
        console.log('图表区域现在占用更多空间，右侧面板更紧凑');
    </script>
</body>
</html>